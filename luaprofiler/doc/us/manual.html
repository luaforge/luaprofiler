<html>
<head>
<!-- See Copyright Notice in license.html-->
<title>LuaProfiler: Time profiler for the Lua programming language</title>
<link rel="stylesheet" href="http://www.keplerproject.org/doc.css" type="text/css">
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
</head>

<body>

<div id="container">
	
<div id="product">
	<div id="product_logo"><a href="http://www.keplerproject.org/luaprofiler">
		<img alt="LuaProfiler logo" src="imgs/luaprofiler.png">

	</a></div>
	<div id="product_name"><big><b>LuaProfiler</b></big></div>
	<div id="product_description">Time profiler for the Lua programming language</div>
</div> <!-- id="product" -->

<div id="main">

<div id="navigation">
<h1>LuaProfiler</h1>
	<ul>
		<li><a href="main.html">Home</a></strong>
			<ul>
				<li> <a href="main.html#over">Overview</a></li>
				<li> <a href="main.html#version">Current Version</a></li>
				<li> <a href="main.html#download">Download</a></li>
				<li> <a href="main.html#installation">Installation</a></li>
				<li> <a href="main.html#hist">History</a></li>
				<li> <a href="main.html#credits">Credits</a></li>
				<li> <a href="main.html#contact">Contact</a></li>
			</ul>
		</li>
		<li><strong>Manual</strong></a>
			<ul>
				<li> <a href="#introduction">Introduction</a></li>
				<li> <a href="#install">Installation and</a></li>
				<li> <a href="#install">compilation</a></li>
				<li> <a href="#analyzer">Using LuaProfiler</a>
			</ul>
		</li>
		<li><a href="license.html">License</a></li>
	</ul>
</div>

<div id="content">

<h2><a name="introduction"></a>Introduction</h2>

<p>	<ul><i>More computing sins are committed in the name of efficiency (without <br>
	necessarily achieving it) than for any other single reason - including <br>
	blind stupidity. <br>
	- W.A. Wulf </i></ul>
</p>

<p>There are several reasons to not optimize your program prematurely. Some 
    of them include unnecessary loss of time, maintainability and robustness. 
</p>

<p>    A profiler tells you what parts of your program are slow, so you can 
    focus on them and forget about the rest. The slow parts are called 
    bottlenecks. A bottleneck is a part of your program that is much slower than 
    the rest of the program. 
</p>

<p>    If you are programming in Lua, as a rule of thumb once you found a 
    bottleneck you have two options: fine tune your code, possibly rewriting 
    some functions in C or, arguably the better option, redesigning your code. </p>

<p>    To fine tune your Lua code, all you need to know is how slow the functions
    are. Then you can rewrite some of them, possibly in C. This option not
    necessarily improves significantly your performance. 
</p>

<p>    To redesign your Lua code, you need more than that: you'll need to know 
    how slow the functions are and which context makes them slow. A general
    solution aims to avoid unnecessary calls and loops.</p>

<p>    When you do that, you reduce the complexity of your code, which can give 
    you much more significant speed improvements in some situations. If you 
    still need to speed things up and redesigning is not a viable option 
    anymore, go ahead and fine tune the slower functions. </p>

<p>    To fine tune, you need only timing numbers, but to redesign you need
    a better view of your program. This profiler helps you in these two 
    processes. 
</p>

<p>    For flexibility reasons, it is divided in 2 parts: the Lua code profiler, 
    written in C to maximize the precision of timing, and the analyzer, written 
    in Lua, that generates information about the program execution. 
</p>

<p>    The code profiler produces as result a table of function calls and times 
    that is usable by the analyzer itself or by a spreadsheet, so you can 
    analyze the results numerically to help you to fine tune your program. </p>

<h2><a name="install"></a>Compilation and installation</h2>

<p>	LuaProfiler can profile programs written in Lua 3.2, Lua 4.0, Lua 5.0 and in LuaNG
(used by older versions of CGILua).
</p>

<p>Edit the <em>config</em> and <em>Makefile</em> according to your Lua installation, then type make.</p>

<p>To profile your program for versions of Lua prior to 5.0, include the "luaProfiler.h" header into your main module,
	include a call to "init_profiler(L)" after opening the Lua library and recompile it
	using the appropriate LuaProfiler lib. If you are profiling Lua 3.2 programs,
	consider "L" to be NULL.</p>

<p>For Lua 5.0, the process is a bit different: we don't need to modify the executable
	file (thanks to compat-5.1 and loadlib). Just put "libprofiler.so" on the library path do <strong>require"profiler"</strong> in your script.<p>

<p>All you need now is to run your program and get the output generated by the
	profiler. The output file is written to the working directory of the program,
	in a file like "lprof_randomid.out".
	By now, a line is generated for every function call in your program, which may
	leed to huge files. Be careful.</p>

<h2><a name="analyzer"></a>Using LuaProfiler</h2>

<p>LuaProfiler includes a script, <em>summary.lua</em>, that analyzes the output the profiler generates and then outputs a table with the functions used by your program and their running times, ordered according to how much of the total execution time of your program the function used. This script needs to be interpreted by Lua 5.0.</p>

<p>Assuming the Lua 5.0 interpreter is in your path, and both summary.lua and your output file are in the same directory, switch to the directory where the output file is and type:</p>

<p><pre>     lua summary.lua lprof_randomid.out</pre></p>

<p>You can also import the output file into a spreadsheet and analyze it there. Each line of the output file is a function call. The first line is a header that explains what each column contains.</p>

</div> <!-- id="content" -->

</div> <!-- id="main" -->

<div id="about">
	<p><a href="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!" height="31" width="88" /></a></p>
	<p><small>

	$Id: manual.html,v 1.1 2005-04-08 17:29:14 carregal Exp $
	</small></p>
</div> <!-- id="about" -->

</div> <!-- id="container" -->

</body>
</html>
